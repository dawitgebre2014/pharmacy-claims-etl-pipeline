# Pharmacy Claims ETL Pipeline (Simulated Databricks Project)

This project demonstrates an end-to-end ETL pipeline for processing pharmacy claims data using SQL and Python. Inspired by real-world PBM operations, it simulates how raw claims data can be transformed into refined, analytics-ready outputs.

## üí° Use Case

Automating pharmacy claims data processing to:
- Filter and clean claims (e.g., only paid claims)
- Generate derived fields such as `claim_month` and `high_cost_flag`
- Summarize claim counts and costs by month and drug
- Streamline reporting and reduce manual effort

## üìÅ Files

| File | Description |
|------|-------------|
| `claims_raw.csv` | Synthetic source data (raw claims) |
| `pipeline_etl.py` | Python script simulating Databricks workflow |
| `pipeline_steps.sql` | SQL version of the transformation logic |
| `claims_summary.csv` | Output summary table (generated by script) |

##  How to Run

### Python ETL:
```bash
python pipeline_etl.py
```
This will generate a `claims_summary.csv` file with monthly and drug-level summaries.

### SQL Alternative:
Use `pipeline_steps.sql` in a SQL environment (Databricks, Snowflake, or SQL Server) with a table named `claims_raw`.

## üìä Sample Metrics in Final Output
- Total claims per drug per month
- Total & average cost
- Count of high-cost claims (> $100)

## üîß Tools Used
- Python (Pandas)
- SQL (CTEs & aggregations)
- Jupyter/Databricks-style modular pipeline approach

## üîç Why This Project?


This simulates a real workflow I‚Äôve built in Databricks to automate weekly PBM reporting. The original version reduced manual data prep by 70% and enabled faster quality checks and delivery of cost insights.

##  Run the Project in Google Colab:

You can explore this project live in your browser using Google Colab. Click the button below to open the interactive notebook without installing anything locally:

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/dawitgebre2014/pharmacy-claims-etl-pipeline/blob/main/pharmacy_claims_etl_colab.ipynb)

This notebook walks through the full ETL pipeline using **Python (Pandas)** to simulate a Databricks job and includes the **equivalent SQL logic** as a reference. It demonstrates how raw pharmacy claims data can be transformed into a structured, reporting-ready format‚Äîideal for cost analysis, forecasting, and adherence monitoring.
## For Databricks version:
 [Download Databricks Notebook Archive (.dbc)](./Pharmacy%20Claims%20ETL.dbc)

---

*Created by Dawit Gebre*
